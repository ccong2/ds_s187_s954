<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-10-18">

<title>Applied Data Science for Cities - Exploratory Data Analysis with </title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Applied Data Science for Cities</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus/index.html" rel="" target="">
 <span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../labs/index.html" rel="" target="" aria-current="page">
 <span class="menu-text">Labs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../howto/index.html" rel="" target="">
 <span class="menu-text">How To</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../resources/index.html" rel="" target="">
 <span class="menu-text">Resources</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../labs/index.html">Labs</a></li><li class="breadcrumb-item"><a href="../labs/lab2.html">02 Opportunity Zones: tidyverse, ggplot2 packages</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Labs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01 Cambridge Building Energy: R, Quarto, dplyr essentials</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">02 Opportunity Zones: tidyverse, ggplot2 packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03 Racial Distribution: tidycensus, tidyr packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04 Airbnb in Chicago: plotly and leaflet packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05 Obesogenic Built Environment: sf, osmdata packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab6.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">06 Shiny Example</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#our-study-topic-today" id="toc-our-study-topic-today" class="nav-link" data-scroll-target="#our-study-topic-today">Our study topic today</a>
  <ul class="collapse">
  <li><a href="#download-data-and-load-packages" id="toc-download-data-and-load-packages" class="nav-link" data-scroll-target="#download-data-and-load-packages">Download data and load packages</a></li>
  </ul></li>
  <li><a href="#read-and-examine-our-data" id="toc-read-and-examine-our-data" class="nav-link" data-scroll-target="#read-and-examine-our-data">Read and examine our data</a>
  <ul class="collapse">
  <li><a href="#your-practice" id="toc-your-practice" class="nav-link" data-scroll-target="#your-practice">Your practice</a></li>
  <li><a href="#your-practice-1" id="toc-your-practice-1" class="nav-link" data-scroll-target="#your-practice-1">Your practice</a></li>
  </ul></li>
  <li><a href="#data-cleanning" id="toc-data-cleanning" class="nav-link" data-scroll-target="#data-cleanning">Data Cleanning</a></li>
  <li><a href="#exploring-variation-within-variables" id="toc-exploring-variation-within-variables" class="nav-link" data-scroll-target="#exploring-variation-within-variables">Exploring Variation Within Variables</a>
  <ul class="collapse">
  <li><a href="#exercise-1" id="toc-exercise-1" class="nav-link" data-scroll-target="#exercise-1">Exercise 1</a></li>
  </ul></li>
  <li><a href="#exploring-variation-between-variables" id="toc-exploring-variation-between-variables" class="nav-link" data-scroll-target="#exploring-variation-between-variables">Exploring Variation Between Variables</a>
  <ul class="collapse">
  <li><a href="#exercise-2" id="toc-exercise-2" class="nav-link" data-scroll-target="#exercise-2">Exercise 2</a></li>
  </ul></li>
  <li><a href="#combinations-of-basic-graphs-to-create-composite-views" id="toc-combinations-of-basic-graphs-to-create-composite-views" class="nav-link" data-scroll-target="#combinations-of-basic-graphs-to-create-composite-views">Combinations of basic graphs to create composite views</a>
  <ul class="collapse">
  <li><a href="#boxplot-and-violin-plots" id="toc-boxplot-and-violin-plots" class="nav-link" data-scroll-target="#boxplot-and-violin-plots">Boxplot and violin plots</a></li>
  <li><a href="#scatterplot-with-marginal-histograms" id="toc-scatterplot-with-marginal-histograms" class="nav-link" data-scroll-target="#scatterplot-with-marginal-histograms">Scatterplot with marginal histograms</a></li>
  </ul></li>
  <li><a href="#work-products" id="toc-work-products" class="nav-link" data-scroll-target="#work-products">Work Products</a>
  <ul class="collapse">
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Exploratory Data Analysis with <img src="../img/Rlogo.png" class="img-fluid" width="60"></h1>
<p class="subtitle lead"><span style="color:#2C3E50">11.S954 Applied Data Science for Cities</span></p>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 18, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1>Overview</h1>
<p>This week’s Lab Exercise focuses on the <a href="https://dplyr.tidyverse.org/index.html">dplyr</a> package and the <a href="https://ggplot2.tidyverse.org">ggplot2</a> package. It also begins to engage with data visualization best practices by demonstrating how to create and interpret a variety of graphics.</p>
<p><strong>Exploratory data analysis (EDA)</strong> is a phase of a larger data science workflow—or perhaps a philosophy—that emphasizes getting to know the data before rushing to analyze it using this more rigid approaches like hypothesis tests. EDA relies heavily on the creation and interpretation of <strong>graphics</strong> in order to build familiarity and gain fundamental insights that can inform more sophisticated analyses later on. There are several overarching goals of exploratory data analysis, including:</p>
<ol type="1">
<li>To determine if there are any problems with your dataset.</li>
<li>To determine whether the question you are asking can be answered by the data that you have.</li>
<li>To begin formulating an answer to your question.</li>
</ol>
</section>
<section id="our-study-topic-today" class="level1">
<h1>Our study topic today</h1>
<p>In the 2017 <a href="https://www.congress.gov/115/bills/hr1/BILLS-115hr1enr.pdf">Tax Cuts and Jobs Act</a>, a new federal incentive was introduced to encourage investment in low-income and undercapitalized communities. States were given the chance to select specific census tracts as Opportunity Zones, where investors could enjoy tax benefits for their eligible investments. Although, there’s been <a href="https://www.urban.org/policy-centers/metropolitan-housing-and-communities-policy-center/projects/opportunity-zones">a lot of curiosity</a> among practitioners and researchers regarding how effective the program is and whether the designations made by governors were successful.</p>
<p>If you are interested in the locations of these Opportunity Zones, you can check out <a href="https://opportunityzones.hud.gov/resources/map">this map</a>. The pink geometries reflected on the map are <a href="https://www.census.gov/programs-surveys/geography/about/glossary.html#par_textimage_13">census tracts</a>, which we often use as a proxy for neighborhoods, especially in urban areas. Just find a familiar place, and see which areas have been designated as Opportunity Zones.</p>
<section id="download-data-and-load-packages" class="level2">
<h2 class="anchored" data-anchor-id="download-data-and-load-packages">Download data and load packages</h2>
<p>Now please navigate to Urban Institute’s website about <a href="https://www.urban.org/policy-centers/metropolitan-housing-and-communities-policy-center/projects/opportunity-zones">Opportunity Zones</a>, find the link “Download tract-level data on all Opportunity Zones”, and <strong>download this dataset</strong> to your “data” folder within your Lab 2 project folder. Open it in Excel and take a quick look. This data lists tracts nationwide that were designated an Opportunity Zones, along with essential Census demographic data that describe these tracts.</p>
<p>To stay organized, you should load packages at the beginning of your script or markdown document. These are the three packages we are going to use today.</p>
</section>
</section>
<section id="read-and-examine-our-data" class="level1">
<h1>Read and examine our data</h1>
<p>Use <code>read_xlsx</code> from the <code>readxl</code> package will read Microsoft Excel files into data tables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>ozs <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"../data/urbaninstitute_tractlevelozanalysis_update01142021.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now look at the “Environment” panel on the top-right of your R interface, you should see the new variable <code>ozs</code>. You can also see this variable 27 variables (columns) and 42178 observations (rows). Click it to preview the content of <code>ozs</code>. Alternatively, you could preview it by typing <code>View(ozs)</code> in your console.</p>
<p>Here are the column definitions:</p>
<ul>
<li><strong>geoid</strong>: combined state, county, tract FIPS (Federal Information Processing Standards) code this is a unique identification number for each census tract. If it is the first time you heard of tracts, they are sub-areas of a county defined for the purpose of taking a census.</li>
<li><strong>state</strong>: the name of the state</li>
<li><strong>county</strong>: the county name</li>
<li><strong>Designated</strong>: 1 if the tract was designated an Opportunity Zone</li>
<li><strong>Type</strong>: category for OZ designation</li>
<li><strong>Population</strong>: total population</li>
<li><strong>PovertyRate</strong>: poverty rate</li>
<li><strong>medhhincome</strong>: median household income</li>
<li><strong>medrent</strong>: median gross rent (per month)</li>
<li><strong>vacancyrate</strong>: residential vacancy rate</li>
<li><strong>unemprate:</strong> unemployment rate</li>
<li><strong>pctwhite</strong>: White non-Hispanic population (%)</li>
<li><strong>pctblack</strong>: Black non-Hispanic population (%)</li>
<li><strong>pctHispanic</strong>: Hispanic and Latino population (%)</li>
<li><strong>Metro</strong>: tract in a metropolitan area</li>
</ul>
<hr>
<section id="your-practice" class="level3">
<h3 class="anchored" data-anchor-id="your-practice">Your practice</h3>
<p>There are commonly used commands in base R that provide an initial check of a dataset, for example:</p>
<ul>
<li><code>dim()</code>, <code>ncol()</code>, <code>nrow()</code></li>
<li><code>colnames()</code></li>
<li><code>glimpse()</code></li>
<li><code>head()</code>, <code>tail()</code></li>
<li><code>str()</code></li>
<li><code>summary()</code></li>
</ul>
<p>Insert a new code chunk and experiment with a few of these functions. What each function accomplishes?</p>
<hr>
<p>Beside examining the basic data structures, There are a few other things I’ll encourage you to inspect during the initial check process:</p>
<p><strong>Completeness</strong></p>
<p>By viewing the first several rows of the dataset, we can already spot some N/A values. For example, there is a field named <code>Designated</code> which is 1 when an eligible tract was designated as an opportunity zone, and N/A where the tract was not designated. (In fact, for our analysis, it’s better to recode these NAs to equal 0 instead, which we will do in a bit).</p>
<p>There are N/As in many of the statistics fields as well, which indicate unavailable information for that specific data point. (If you never see “N/A” in the first 20 some rows, it will be too soon).</p>
<p>How many missing values are there and would that be a hurdle for my analysis? It will be great to have a sense of completeness in terms of what proportion of a field actually holds data. <code>DataExplorer</code> is a handy tool to quickly understand datasets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>DataExplorer<span class="sc">::</span><span class="fu">plot_missing</span>(ozs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab2_files/figure-html/missingvalues-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Unique values of categorical variables</strong></p>
<p>The <code>unique()</code> base R function extracts unique elements in a large set of values. We can use it to specific columns to see what entries we have here. It also helps us to see if there is anything we need to clean up, such as typos or incorrect names, before proceeding to more analysis. For this dataset, we can take a look at the <code>state</code> column. What we have here in this column are all U.S. territories as well as a few NA values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(ozs<span class="sc">$</span>state) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Alabama"                  "Alaska"                  
 [3] "Arizona"                  "Arkansas"                
 [5] "California"               "Colorado"                
 [7] "Connecticut"              "Delaware"                
 [9] "District of Columbia"     "Florida"                 
[11] "Georgia"                  "Hawaii"                  
[13] "Idaho"                    "Illinois"                
[15] "Indiana"                  "Iowa"                    
[17] "Kansas"                   "Kentucky"                
[19] "Louisiana"                "Maine"                   
[21] "Maryland"                 "Massachusetts"           
[23] "Michigan"                 "Minnesota"               
[25] "Mississippi"              "Missouri"                
[27] "Montana"                  "Nebraska"                
[29] "Nevada"                   "New Hampshire"           
[31] "New Jersey"               "New Mexico"              
[33] "New York"                 "North Carolina"          
[35] "North Dakota"             "Ohio"                    
[37] "Oklahoma"                 "Oregon"                  
[39] "Pennsylvania"             "Rhode Island"            
[41] "South Carolina"           "South Dakota"            
[43] "Tennessee"                "Texas"                   
[45] "Utah"                     "Vermont"                 
[47] "Virginia"                 "Washington"              
[49] "West Virginia"            "Wisconsin"               
[51] "Wyoming"                  "American Samoa"          
[53] NA                         "Guam"                    
[55] "Northern Mariana Islands" "Puerto Rico"             
[57] "Virgin Islands"          </code></pre>
</div>
</div>
<p><strong>Range of numerical variables</strong></p>
<p>For numeric columns, it’ll be helpful to visually inspect whether the values fall within the expected range, how the values are distributed, and whether there are any wacky numbers like -999 (often used in SPSS files to indicate missing data), etc. A quick histogram helps us to see the value distribution. Additionally, it visualizes patterns by dividing the data set into groups (or bins) of equal length, then communicating how many or what proportion of the observations fall within each of those “bins”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can use the base R function hist() to check one variable:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ozs<span class="sc">$</span>Population)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab2_files/figure-html/hist-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or use the DataExplorer package to check multiple variables at the same time</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>DataExplorer<span class="sc">::</span><span class="fu">plot_histogram</span>(ozs[,<span class="fu">c</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">13</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab2_files/figure-html/hist-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
</section>
<section id="your-practice-1" class="level3">
<h3 class="anchored" data-anchor-id="your-practice-1">Your practice</h3>
<p>Check the <code>DesignatedOZ</code> column - what values does it contain?</p>
<hr>
</section>
</section>
<section id="data-cleanning" class="level1">
<h1>Data Cleanning</h1>
<p>The Urban Institute has coded the designated variable as either taking a value of 1 when designated or NA when not. We can recode the NA values in <code>DesignatedOZ</code> for legibility. In the following code, we uses the <code>dplyr</code> function: <code>mutate</code> to modify <code>DesignatedOZ</code> in place. We replaced the numbers with texts since the NA and 1 here have no mathematical meaning.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ozs <span class="ot">&lt;-</span> ozs <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">DesignatedOZ =</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">ifelse</span>(<span class="fu">is.na</span>(DesignatedOZ), <span class="st">"Not Designated"</span>, <span class="st">"Designated"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are a few columns (such as <code>SE_Flag</code>) that we won’t need for this analysis. We can use <code>select</code> in <code>dplyr</code> function to select a subset of columns to work on. <code>select</code> allows you to retain specified columns. If there is a minus sign in front, that means to drop these specified columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ozs <span class="ot">&lt;-</span> ozs <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(dec_score, SE_Flag, Metro, Micro, NoCBSAType))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exploring-variation-within-variables" class="level1">
<h1>Exploring Variation Within Variables</h1>
<p>The code chunk below creates a <strong>boxplot</strong> to contrast the distribution of poverty rates between designated opportunity zones and undesignated zones. A boxplot is a very commonly used EDA tool that allows us to quickly visualize the distribution of a single variable or column of data if we are working with a data frame. Note that we are using what should now be familiar conventions to construct the graphic beginning with the <code>ggplot</code> function, then adding more features with the <code>+</code> operator and other functions <a href="https://ggplot2.tidyverse.org/reference/index.html">listed in the package reference</a>.</p>
<ul>
<li><code>ggplot(data = ozs)</code>: This is the main plotting function. <code>ozs</code> is your dataset we use.</li>
<li><code>geom_boxplot()</code>: Recall that geometric layers are called <strong>geoms</strong>. It tells R what kind of geometry you want to use visualize the data.</li>
<li><code>aes(x = DesignatedOZ, y = PovertyRate)</code>: The <code>aes()</code> function is where you tell <code>ggplot</code> which variable goes on the x axis followed by which variable goes on the y axis.</li>
<li>The <code>labs</code> function sets the labels. Because the legend is showing the <strong>fill</strong> component of the plot, we use the <strong>fill</strong> argument in the <code>labs</code> function to set the name of the legend itself.</li>
<li>We used a new function <code>scale_y_continuous</code> to specify y axis properties. Here we are making sure the poverty rate are labeled as <strong>percentages</strong>. If you remove this line, they will by default show as decimal numbers.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ozs) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> DesignatedOZ, <span class="at">y =</span> PovertyRate, <span class="at">fill =</span> DesignatedOZ)) <span class="sc">+</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">""</span>, <span class="at">x =</span> <span class="st">"Opportunity Zone Eligible Tracts"</span>, <span class="at">y =</span> <span class="st">"Poverty Rate"</span>, <span class="at">fill =</span> <span class="st">"Tracts"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab2_files/figure-html/boxplot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can create <strong>cross-tabulations</strong> as a complement to visual EDA tools like boxplots and histograms. An easy way to do this is to use the existing function <code>count</code> in the <code>dplyr</code> package. A brief demonstration is given in the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>ozs <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(state, DesignatedOZ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 108 × 3
   state          DesignatedOZ       n
   &lt;chr&gt;          &lt;chr&gt;          &lt;int&gt;
 1 Alabama        Designated       158
 2 Alabama        Not Designated   677
 3 Alaska         Designated        25
 4 Alaska         Not Designated    43
 5 American Samoa Designated        16
 6 Arizona        Designated       168
 7 Arizona        Not Designated   702
 8 Arkansas       Designated        85
 9 Arkansas       Not Designated   435
10 California     Designated       879
# ℹ 98 more rows</code></pre>
</div>
</div>
<section id="exercise-1" class="level3">
<h3 class="anchored" data-anchor-id="exercise-1">Exercise 1</h3>
<p>Insert a new code chunk and a markdown section below this one to “catch” your responses. Please review what we have learned and proceed with the questions below.</p>
<ol type="1">
<li>Which of the variables (columns) are continuous and which are categorical (e.g., factor)?
<ul>
<li>Hint: Recall that a variable is categorical if it can only take one of a small set of values and continuous if it can take any of an infinite set of ordered values.</li>
<li>Which function or approach did you use to answer this question?</li>
</ul></li>
<li>How is the median household income distributed across the places?
<ul>
<li>Hint: Should we expect to see a more flat/homogeneous distribution, or a more skewed distribution in terms of fewer households belonging to the higher-income group?</li>
<li>Which function or approach did you use to answer this question?</li>
</ul></li>
<li>Create a graphic that contrasts the distribution of the unemployment rate in designated zones and in undesignated zones in this dataset.
<ul>
<li>Interpret the graphic(s) you have created and include 2-3 sentences of text explanation (i.e., in an RMarkdown section)</li>
</ul></li>
</ol>
</section>
</section>
<section id="exploring-variation-between-variables" class="level1">
<h1>Exploring Variation Between Variables</h1>
<p>We are often interested in bivariate relationships or how two variables relate to one another. <strong>Scatterplots</strong> are often used to visualize the association between two <strong>continuous variables</strong>. They can reveal much about the <a href="https://www.jmp.com/en_hk/statistics-knowledge-portal/exploratory-data-analysis/scatter-plot.html">nature of the relationship</a> between two variables.</p>
<p>Let’s use a subset of our data - tracts in Massachusetts - to perform this part of analysis. You can definitely use the entire dataset, it’s just there will be over 40,000 points showing on the graph.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>ozs_ma <span class="ot">&lt;-</span> ozs <span class="sc">|&gt;</span> <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Massachusetts"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we begin by creating a scatterplot of poverty rate and unemployment rate. Note that we used <code>theme_bw</code>, which is a <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html"><code>theme</code> template</a> for a cleaner look.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ozs_ma) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(unemprate, PovertyRate)) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Poverty rate vs. unemployment rate in Opportunity Zone eligible tracts"</span>, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"State of Massachusetts"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Unemployment rate"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Poverty rate"</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Source: Urban Institute (2018)"</span>) <span class="sc">+</span> </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab2_files/figure-html/Scatterplot-Copper-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>It is generally easy to recognize patterns in a graphical display. As we move from left to right along the x-axis (i.e., as unthe employment rate creases), the amount of poverty rate reported also increases.</p>
<p>As a complement to the scatterplot, we can use the base R <code>cor</code> function to calculate the (Pearson by default, see the documentation for other options) <strong>correlation</strong> between any continuous variables in the dataset. The <code>DataExplorer</code> package is also designed to help us quickly understand patterns in our data. We demonstrate both in the following code.</p>
<p>If you are unfamiliar with reading a correlation matrix, the values range between -1 and 1 where:</p>
<ul>
<li>-1 indicates a perfectly negative linear correlation between two variables</li>
<li>0 indicates no linear correlation between two variables</li>
<li>1 indicates a perfectly positive linear correlation between two variables</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>ozs_ma <span class="sc">|&gt;</span> <span class="fu">select</span>(Population<span class="sc">:</span>medrent, pctwhite<span class="sc">:</span>BAorhigher) <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">cor</span>(<span class="at">use =</span> <span class="st">"complete.obs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Population medhhincome PovertyRate  unemprate    medvalue
Population    1.0000000000   0.1971310 -0.17219731 -0.1255690  0.05060663
medhhincome   0.1971310072   1.0000000 -0.74280330 -0.5823090  0.45672297
PovertyRate  -0.1721973144  -0.7428033  1.00000000  0.5848120 -0.15673933
unemprate    -0.1255690086  -0.5823090  0.58481204  1.0000000 -0.32627434
medvalue      0.0506066324   0.4567230 -0.15673933 -0.3262743  1.00000000
medrent       0.1434824928   0.6494977 -0.32058250 -0.4139894  0.60946764
pctwhite      0.0007742062   0.4334837 -0.58166274 -0.4583927  0.01479243
pctBlack      0.0305972149  -0.2081070  0.24067220  0.3002354  0.07662521
pctHispanic  -0.0610330071  -0.4470198  0.53817440  0.4107687 -0.24108925
pctAAPIalone  0.1179507879   0.1360442  0.05777953 -0.1516819  0.38403023
pctunder18    0.0075944281  -0.3886837  0.28931873  0.4263952 -0.48597184
pctover64    -0.0200934534   0.1116477 -0.40837729 -0.2236285 -0.08790793
HSorlower    -0.0510755304  -0.6192728  0.38428550  0.5080771 -0.59138685
BAorhigher    0.0317046620   0.5837037 -0.24483958 -0.4850706  0.71630822
                 medrent      pctwhite    pctBlack pctHispanic pctAAPIalone
Population    0.14348249  0.0007742062  0.03059721 -0.06103301   0.11795079
medhhincome   0.64949767  0.4334836763 -0.20810703 -0.44701977   0.13604425
PovertyRate  -0.32058250 -0.5816627414  0.24067220  0.53817440   0.05777953
unemprate    -0.41398938 -0.4583927470  0.30023542  0.41076874  -0.15168191
medvalue      0.60946764  0.0147924343  0.07662521 -0.24108925   0.38403023
medrent       1.00000000  0.0592656294 -0.01942961 -0.21839927   0.37309846
pctwhite      0.05926563  1.0000000000 -0.64391155 -0.72603098  -0.14608318
pctBlack     -0.01942961 -0.6439115534  1.00000000  0.05756055  -0.07150764
pctHispanic  -0.21839927 -0.7260309801  0.05756055  1.00000000  -0.16352352
pctAAPIalone  0.37309846 -0.1460831806 -0.07150764 -0.16352352   1.00000000
pctunder18   -0.47107334 -0.4866220916  0.28987714  0.52756318  -0.29072583
pctover64    -0.20439363  0.5440272257 -0.22702697 -0.42430798  -0.23991183
HSorlower    -0.59290214 -0.4609030805  0.16871183  0.56358387  -0.25180077
BAorhigher    0.67357448  0.3278345358 -0.19790460 -0.42390213   0.38422347
               pctunder18    pctover64   HSorlower   BAorhigher
Population    0.007594428 -0.020093453 -0.05107553  0.031704662
medhhincome  -0.388683691  0.111647722 -0.61927277  0.583703714
PovertyRate   0.289318732 -0.408377288  0.38428550 -0.244839584
unemprate     0.426395199 -0.223628488  0.50807715 -0.485070585
medvalue     -0.485971837 -0.087907931 -0.59138685  0.716308223
medrent      -0.471073339 -0.204393629 -0.59290214  0.673574479
pctwhite     -0.486622092  0.544027226 -0.46090308  0.327834536
pctBlack      0.289877141 -0.227026967  0.16871183 -0.197904602
pctHispanic   0.527563183 -0.424307981  0.56358387 -0.423902133
pctAAPIalone -0.290725828 -0.239911831 -0.25180077  0.384223470
pctunder18    1.000000000 -0.248306018  0.68045309 -0.718007353
pctover64    -0.248306018  1.000000000 -0.14789121 -0.003268322
HSorlower     0.680453091 -0.147891209  1.00000000 -0.923184800
BAorhigher   -0.718007353 -0.003268322 -0.92318480  1.000000000</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>ozs_ma <span class="sc">|&gt;</span> <span class="fu">select</span>(Population<span class="sc">:</span>medrent, pctwhite<span class="sc">:</span>BAorhigher) <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  DataExplorer<span class="sc">::</span><span class="fu">plot_correlation</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab2_files/figure-html/correlation-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>An additional note to the code above is that we selected several continuous variables that we want to inspect, and removed NA values so that the correlation values can be correctly calculated.</p>
<hr>
<p>What can we do if we are interested in statistical associations between <strong>categorical variables</strong>? The typical approach is to summarise the values under each category and visualize them using <strong>barcharts</strong>.</p>
<p>In the following code, you can see our familiar <code>group_by</code> + <code>summarise</code> process used to calculate the average median house income by county in Massachusetts. This summarized table is then piped to <code>ggplot()</code> for visualization.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ozs_ma <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(county, DesignatedOZ) <span class="sc">|&gt;</span>  </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Tracts =</span> <span class="fu">n</span>(),</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Income =</span> <span class="fu">mean</span>(medhhincome, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> county, <span class="at">y =</span> Income, <span class="at">fill =</span> DesignatedOZ), </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="st">"dodge"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab2_files/figure-html/barchart-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="exercise-2" class="level3">
<h3 class="anchored" data-anchor-id="exercise-2">Exercise 2</h3>
<p>Take a few minutes to read this bar chart below:</p>
<p><img src="../img/lab2-emp.png" class="img-fluid"></p>
<p>How can we modify our code above to replicate the bar chart in this image? You’ll notice that you can achieve most of the features by tweaking our previous examples, plus a little bit more exploration. <strong>In a new code chunk,</strong> please copy and paste our last bar chart code, and try your best to address the following questions.</p>
<ol type="1">
<li>Please add the title, subtitle, x- and y-axis labels, and the data source annotation to your bar chart.</li>
<li>The background looks much cleaner. Please choose a theme template for your bar chart.</li>
<li>The x-axis labels are titled to 45 degrees. How can I achieve this? <a href="https://ggplot2.tidyverse.org/reference/theme.html">Hint</a>.</li>
<li>The labels on the y-axis are formatted in thousands with commas. This can be achieved by modifying the function <code>scale_y_continuous(labels = scales::percent)</code> we have seen before. <a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">Hint</a>.</li>
<li>Lastly, the counties are not arranged alphabetically, but rather by the income values mapped to the y-axis, starting from large to small. How can I achieve this? <a href="https://blog.albertkuo.me/post/2022-01-04-reordering-geom-col-and-geom-bar-by-count-or-value/">Hint</a>.</li>
</ol>
</section>
</section>
<section id="combinations-of-basic-graphs-to-create-composite-views" class="level1">
<h1>Combinations of basic graphs to create composite views</h1>
<section id="boxplot-and-violin-plots" class="level2">
<h2 class="anchored" data-anchor-id="boxplot-and-violin-plots">Boxplot and violin plots</h2>
<p>The compilation of boxplot and violin plot can be effective ways to visualize key statistics and the number of observations throughout the range. There are a few new arguments in the following code for adjusting the aesthetics.<br>
<code>trim = FALSE</code>: If TRUE (default), trim the tails of the violins to the range of the data. If FALSE, don’t trim the tails.<br>
<code>alpha = 0.5</code>: the transparency of the plotting area.<br>
<code>coord_flip()</code>: whether the y axis is displayed horizonally or vertically.<br>
<code>legend.position = "none"</code>: the position of legends (“none”, “left”, “right”, “bottom”, “top”, or two-element numeric vector).</p>
<p>You can try to remove them or change their values to see how they work.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ozs_ma) <span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">x =</span> DesignatedOZ, <span class="at">y =</span> medhhincome, <span class="at">fill =</span> DesignatedOZ), <span class="at">trim =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> DesignatedOZ, <span class="at">y =</span> medhhincome), <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">width =</span> .<span class="dv">15</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Designated"</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Median Household Income"</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Median Household Income"</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab2_files/figure-html/extra-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="scatterplot-with-marginal-histograms" class="level2">
<h2 class="anchored" data-anchor-id="scatterplot-with-marginal-histograms">Scatterplot with marginal histograms</h2>
<p>This requires a new package <code>ggExtra</code>. But the other syntax should be familiar now.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ozs_ma, <span class="fu">aes</span>(pctBlack, PovertyRate)) <span class="sc">+</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> DesignatedOZ)) <span class="sc">+</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>ggExtra<span class="sc">::</span><span class="fu">ggMarginal</span>(p, <span class="at">type =</span> <span class="st">"histogram"</span>, <span class="at">groupFill =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab2_files/figure-html/extra-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="work-products" class="level1">
<h1>Work Products</h1>
<p>Please submit <strong>a .qmd file</strong> and <strong>a</strong> <strong>knitted HTML file</strong> that shows your work and responses for each of the <strong>two</strong> <strong>Exercises</strong> included in this lab.</p>
<p>Is there a distinguishable difference in economic conditions between designated and not-designated census tracts? Please comment on the graphics we have created, and discuss what you have found so far. Talk about any specific aspects you would like to further investigate on this question.</p>
<p>Also, briefly comment on your experience with R during this lab exercise. Please <strong>upload your report to Canvas</strong> <strong>by the end of day, Tuesday, Nov 7.</strong></p>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section"></h3>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Made with R and <a href="https://quarto.org/">Quarto</a></div>
  </div>
</footer>



</body></html>